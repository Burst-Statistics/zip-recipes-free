jQuery(document).ready(function(d){d("body > :not(#zrdn-recipe-container)").hide();d("#zrdn-recipe-container").appendTo("body");var e=g();for(var j in e){if(e.hasOwnProperty(j)){var i=e[j];if(d(".zrdn-element_"+i.name).prop("tagName")==="OL"||d(".zrdn-element_"+i.name).prop("tagName")==="UL"){d(".zrdn-element_"+i.name).nextAll().remove()}d(".zrdn-element_"+i.name).html((i.value))}}h(e);c(e);b(e);k(e);function g(){var p=window.location.href;var r=p.split("?");if(r.length===1){return false}var m=r[1].split("&");var o=[];for(var n in m){if(m.hasOwnProperty(n)){var l=m[n].split("=");var q=new Object();q.name=l[0];q.value=decodeURIComponent(l[1]);console.log(q.value);if(q.name!=="mode"&&q.name!=="recipe_image"){o.push(q)}}}return o}function c(m){var n=new Object();var l=new Object();var r=new Object();for(var p in m){if(m.hasOwnProperty(p)){var q=m[p];var o=q.name;if(o.indexOf("prep")!=-1){if(o.indexOf("minute")!==-1){n.minutes=q.value}if(o.indexOf("hour")!==-1){n.hours=q.value}}if(o.indexOf("cook")!=-1){if(o.indexOf("minute")!==-1){l.minutes=q.value}if(o.indexOf("hour")!==-1){l.hours=q.value}}if(o.indexOf("wait")!=-1){if(o.indexOf("minute")!==-1){r.minutes=q.value}if(o.indexOf("hour")!==-1){r.hours=q.value}}}d(".zrdn-element_prep_time").html(f(n.hours,n.minutes));d(".zrdn-element_cook_time").html(f(l.hours,l.minutes));d(".zrdn-element_wait_time").html(f(r.hours,r.minutes));d(".zrdn-element_total_time").html(f(parseInt(n.hours)+parseInt(l.hours),parseInt(n.minutes)+parseInt(l.minutes)))}}function f(l,m){var n="";if(l>0){n+=l+" "+zrdn_editor_preview.str_hours}if(m>0){if(n.length>0){m=", "+m}n+=m+" "+zrdn_editor_preview.str_minutes}return n}function h(l){if(!d("#zrdn-nutrition-label").length){return}var m=a(l,"calories");var n=d("#zrdn-nutrition-label");if(parseInt(m.value)===0){n.hide()}else{n.show()}}function b(l){var m=a(l,"video_url");var n=m.value;d.ajax({type:"GET",url:zrdn_editor_preview.admin_url,dataType:"json",data:({video_url:n,action:"zrdn_get_embed_code"}),success:function(o){if(o.success){d(".zrdn-element_"+m.name).html(o.embed)}}})}function a(l,m){for(var n in l){if(l.hasOwnProperty(n)){var o=l[n];if(o.name===m){return o}}}return false}function k(l){var p=a(l,"recipe_id");var n=p.value;d(".zrdn-element_recipe_image").append('<div class="zrdn-image-controls"><div class="zrdn-edit-image-text"><div class="dashicons dashicons-edit"></div></div></div>');var o='<span class="zrdn-image-controls-divider">|</span><a href="#" class="zrdn_remove_image"><div class="dashicons dashicons-trash"></div></a>';d(".zrdn-element_recipe_image .zrdn-image-controls").append(o);var m=null;d(document).on("click",".zrdn-element_recipe_image img, .dashicons-edit",function(){var q=d(this);m=wp.media({frame:"post",state:"insert",multiple:false});m.on("insert",function(){q.wrap('<div class="loading-gif"></div>');d(q).load(function(){q.unwrap()});var u=m.state().get("selection").length;var r=m.state().get("selection").models;for(var t=0;t<u;t++){var s=r[t].id;var v;if(r[t].attributes.sizes.hasOwnProperty("zrdn_recipe_image_main")){v=r[t].attributes.sizes.zrdn_recipe_image_main}else{if(r[t].attributes.sizes.hasOwnProperty("zrdn_recipe_image")){v=r[t].attributes.sizes.zrdn_recipe_image}else{if(r[t].attributes.sizes.hasOwnProperty("large")){v=r[t].attributes.sizes.large}else{v=r[t].attributes.sizes.full}}}var w=v.url;q.attr("src",w);d.ajax({type:"POST",url:zrdn_editor_preview.admin_url,dataType:"json",data:({recipe_id:n,recipe_image_id:s,recipe_image:w,action:"zrdn_update_recipe_image"}),success:function(x){if(x.success){}}})}});m.open()});d(document).on("click",".zrdn_remove_image, .dashicons-trash",function(q){q.preventDefault();var r=d(this).closest(".zrdn-element_recipe_image").find("img");d.ajax({type:"POST",url:zrdn_editor_preview.admin_url,dataType:"json",data:({recipe_id:n,nonce:zrdn_editor_preview.nonce,action:"zrdn_clear_image"}),success:function(s){if(s.success){r.attr("src",zrdn_editor_preview.default_image);r.attr("srcset",zrdn_editor_preview.default_image)}else{r.parent().append(" Clearing image failed...")}}})})}});