jQuery(document).ready(function(f){f.fn.outerHTML=function(){return(!this.length)?this:(this[0].outerHTML||(function(i){var k=document.createElement("div");k.appendChild(i.cloneNode(true));var j=k.innerHTML;k=null;return j})(this[0]))};f(document).on("click",".zrdn-tablinks",function(){f(".zrdn-tablinks").removeClass("active");f(this).addClass("active");f(".zrdn-tabcontent").removeClass("active");f("#"+f(this).data("tab")).addClass("active");f("input[name=zrdn_active_tab]").val(f(this).data("tab"))});var e=f("#zrdn-preview").html();var a=e.match(/{"@context".*?}}/g,"");if(a){e=e.replace(a[0],"")}var d=/(<.+?>[^<>]*?){([a-zA-Z_].*)_value}([^<>]*?<.+?>)/g;e=e.replace(d,'$1<span id="zrdn_placeholder_$2"></span>$3');f("#zrdn-preview").html(e);f(".prep_time").html('<span id="zrdn_placeholder_prep_time"></span>');f(".cook_time").html('<span id="zrdn_placeholder_cook_time"></span>');f(".zrdn-recipe-image").parent().append('<span class="zrdn-edit-image-text">'+zrdn_editor.str_click_to_edit_image+"</span>");f(".zrdn-field-input").each(function(){var j=f(this).attr("name");var i=j.replace("zrdn_","zrdn_placeholder_");f("#"+i).html(f(this).val())});f("input[type=number]").each(function(){g(f(this))});f(".zrdn-field-textarea").each(function(){c(f(this))});if(f("input[name=zrdn_recipe_image]").val().length>0){f(".zrdn-recipe-image").attr("src",f("input[name=zrdn_recipe_image]").val())}f(document).on("keyup","input[type=text]",function(k){h();var j=f(this).attr("name");if(j===undefined){return}if(j.indexOf("zrdn_")===-1){return}var i=j.replace("zrdn_","zrdn_placeholder_");f("#"+i).html(f(this).val())});f(document).on("keyup mouseup","input[type=number]",function(i){g(f(this))});f(document).on("keyup","textarea",function(i){c(f(this))});function g(o){var l=o.attr("name");if(l.indexOf("zrdn_")===-1){return}var k=l.replace("_minutes","").replace("_hours","");var m=parseInt(f("input[name="+k+"_minutes]").val());var i=parseInt(f("input[name="+k+"_hours]").val());var j=k.replace("zrdn_","zrdn_placeholder_");var n="";if(i>0){n+=i+" "+zrdn_editor.str_hours}if(m>0){if(n.length>0){m=", "+m}n+=m+" "+zrdn_editor.str_minutes}f("#"+j).html(n)}function c(m){var k=m.attr("name");if(k.indexOf("zrdn_")===-1){return}var j;var v="UL";var q=k.replace("zrdn_","zrdn_placeholder_");var s=f("#"+q);s.html("");var n=s.outerHTML();if(s.parent().prop("tagName")==="LI"){j=s.parent().parent()}else{j=s.parent()}v=j.prop("tagName");var u=m.val().split("\n");u=u.filter(Boolean);u.forEach(function(x){if(x.substring(0,1)==="!"){n+="</"+v+"><b>"+x.substring(1)+"</b><"+v+">"}else{if(x.substring(0,1)==="%"){var y=/(?:%)([http|https?:\/\/=?\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:\/?#[\]@!\$&'\(\)\*\+,;=.\/]+[a-zA-N])/g;var w=x.match(y);if(w){var i=w[0];var z=i.substring(1);n+=x.replace(i,'<img style="max-width:100%" src="'+z+'">')}}else{n+="<li>"+x+"</li>"}}});if(n.length){var l;var t=/(\*[a-zA-Z\-\_\(\)\<\>\/\\\$\!\@\#\:\;\.\,\?\+\=]*\*)/g;var p=n.match(t);if(p&&p.length){for(l=0;l<p.length;l++){var o=p[l];var r=o;r=r.replace(/\*$/i,"</b>").replace(/^\*/i,"<b>");n=n.replace(o,r)}}t=/\[([^\]\|\[]*)\|([^\]\|\[]*)\]/g;p=n.match(t);if(p&&p.length){for(l=0;l<p.length;l++){n=n.replace(/\[([^\]\|\[]*)\|([^\]\|\[]*)\]/i,'<a href="$1">$2</a>')}}}j.html(n)}var b=null;f(document).on("click",".zrdn-recipe-image",function(){var i=f(this);b=wp.media({frame:"post",state:"insert",multiple:false});b.on("insert",function(){i.wrap('<div class="loading-gif"></div>');f(i).load(function(){i.unwrap()});var m=b.state().get("selection").length;var j=b.state().get("selection").models;for(var l=0;l<m;l++){var k=j[l].id;var n;if(j[l].attributes.sizes.hasOwnProperty("zrdn_recipe_image")){n=j[l].attributes.sizes.zrdn_recipe_image}else{if(j[l].attributes.sizes.hasOwnProperty("large")){n=j[l].attributes.sizes.large}else{n=j[l].attributes.sizes.full}}var o=n.url;i.attr("src",o);f("input[name=zrdn_recipe_image_id]").val(k);f("input[name=zrdn_recipe_image]").val(o)}});b.open()});setTimeout(function(){for(var j=0;j<tinymce.editors.length;j++){tinymce.editors[j].onChange.add(function(k,m){var l=k.id;console.log(l);var i=l.replace("zrdn_","zrdn_placeholder_");console.log(i);f("#"+i).html(k.getContent())});tinymce.editors[j].onKeyUp.add(function(k,m){var l=k.id;console.log(l);var i=l.replace("zrdn_","zrdn_placeholder_");console.log(i);f("#"+i).html(k.getContent())})}},1000);h();function h(){if(!f("#zrdn-nutrition-label").length){return}var i=f("#zrdn-nutrition-label");if(f("input[name=zrdn_calories]").val().length===0){i.hide()}else{i.show()}}});