jQuery(document).ready(function(e){e.fn.outerHTML=function(){return(!this.length)?this:(this[0].outerHTML||(function(h){var j=document.createElement("div");j.appendChild(h.cloneNode(true));var i=j.innerHTML;j=null;return i})(this[0]))};e(document).on("click",".zrdn-tablinks",function(){e(".zrdn-tablinks").removeClass("active");e(this).addClass("active");e(".zrdn-tabcontent").removeClass("active");e("#"+e(this).data("tab")).addClass("active");e("input[name=zrdn_active_tab]").val(e(this).data("tab"))});var d=e("#zrdn-preview").html();var a=d.match(/{"@context".*?}}/g,"");if(a){d=d.replace(a[0],"")}d=d.replace(/(?<!="){([a-zA-Z_].*)_value}/g,'<span id="zrdn_placeholder_$1"></span>');e("#zrdn-preview").html(d);e(".prep_time").html('<span id="zrdn_placeholder_prep_time"></span>');e(".cook_time").html('<span id="zrdn_placeholder_cook_time"></span>');e(".zrdn-recipe-image").parent().append('<span class="zrdn-edit-image-text">'+zrdn_editor.str_click_to_edit_image+"</span>");e(".zrdn-field-input").each(function(){var i=e(this).attr("name");var h=i.replace("zrdn_","zrdn_placeholder_");e("#"+h).html(e(this).val())});e("input[type=number]").each(function(){f(e(this))});e(".zrdn-field-textarea").each(function(){c(e(this))});if(e("input[name=zrdn_recipe_image]").val().length>0){e(".zrdn-recipe-image").attr("src",e("input[name=zrdn_recipe_image]").val())}e(document).on("keyup","input[type=text]",function(j){g();var i=e(this).attr("name");if(i===undefined){return}if(i.indexOf("zrdn_")===-1){return}var h=i.replace("zrdn_","zrdn_placeholder_");e("#"+h).html(e(this).val())});e(document).on("keyup mouseup","input[type=number]",function(h){f(e(this))});e(document).on("keyup","textarea",function(h){c(e(this))});function f(n){var k=n.attr("name");if(k.indexOf("zrdn_")===-1){return}var j=k.replace("_minutes","").replace("_hours","");var l=parseInt(e("input[name="+j+"_minutes]").val());var h=parseInt(e("input[name="+j+"_hours]").val());var i=j.replace("zrdn_","zrdn_placeholder_");var m="";if(h>0){m+=h+" "+zrdn_editor.str_hours}if(l>0){if(m.length>0){l=", "+l}m+=l+" "+zrdn_editor.str_minutes}e("#"+i).html(m)}function c(l){var j=l.attr("name");if(j.indexOf("zrdn_")===-1){return}var h;var u="UL";var p=j.replace("zrdn_","zrdn_placeholder_");var r=e("#"+p);r.html("");var m=r.outerHTML();if(r.parent().prop("tagName")==="LI"){h=r.parent().parent()}else{h=r.parent()}u=h.prop("tagName");var t=l.val().split("\n");t=t.filter(Boolean);t.forEach(function(w){if(w.substring(0,1)==="!"){m+="</"+u+"><b>"+w.substring(1)+"</b><"+u+">"}else{if(w.substring(0,1)==="%"){var x=/(?:%)([http|https?:\/\/=?\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:\/?#[\]@!\$&'\(\)\*\+,;=.\/]+[a-zA-N])/g;var v=w.match(x);if(v){var i=v[0];var y=i.substring(1);m+=w.replace(i,'<img style="max-width:100%" src="'+y+'">')}}else{m+="<li>"+w+"</li>"}}});if(m.length){var k;var s=/(\*[a-zA-Z\-\_\(\)\<\>\/\\\$\!\@\#\:\;\.\,\?\+\=]*\*)/g;var o=m.match(s);if(o&&o.length){for(k=0;k<o.length;k++){var n=o[k];var q=n;q=q.replace(/\*$/i,"</b>").replace(/^\*/i,"<b>");m=m.replace(n,q)}}s=/\[([^\]\|\[]*)\|([^\]\|\[]*)\]/g;o=m.match(s);if(o&&o.length){for(k=0;k<o.length;k++){m=m.replace(/\[([^\]\|\[]*)\|([^\]\|\[]*)\]/i,'<a href="$1">$2</a>')}}}h.html(m)}var b=null;e(document).on("click",".zrdn-recipe-image",function(){var h=e(this);b=wp.media({frame:"post",state:"insert",multiple:false});b.on("insert",function(){h.wrap('<div class="loading-gif"></div>');e(h).load(function(){h.unwrap()});var l=b.state().get("selection").length;var i=b.state().get("selection").models;for(var k=0;k<l;k++){var j=i[k].id;var m;if(i[k].attributes.sizes.hasOwnProperty("zrdn_recipe_image")){m=i[k].attributes.sizes.zrdn_recipe_image}else{if(i[k].attributes.sizes.hasOwnProperty("large")){m=i[k].attributes.sizes.large}else{m=i[k].attributes.sizes.full}}var n=m.url;h.attr("src",n);e("input[name=zrdn_recipe_image_id]").val(j);e("input[name=zrdn_recipe_image]").val(n)}});b.open()});setTimeout(function(){for(var h=0;h<tinymce.editors.length;h++){tinymce.editors[h].onChange.add(function(j,l){var k=j.id;console.log(k);var i=k.replace("zrdn_","zrdn_placeholder_");console.log(i);e("#"+i).html(j.getContent())});tinymce.editors[h].onKeyUp.add(function(j,l){var k=j.id;console.log(k);var i=k.replace("zrdn_","zrdn_placeholder_");console.log(i);e("#"+i).html(j.getContent())})}},1000);g();function g(){if(!e("#zrdn-nutrition-label").length){return}var h=e("#zrdn-nutrition-label");if(e("input[name=zrdn_calories]").val().length===0){h.hide()}else{h.show()}}});