jQuery(document).ready(function(e){e.fn.outerHTML=function(){return(!this.length)?this:(this[0].outerHTML||(function(j){var l=document.createElement("div");l.appendChild(j.cloneNode(true));var k=l.innerHTML;l=null;return k})(this[0]))};e(document).on("click",".zrdn-tablinks",function(){e(".zrdn-tablinks").removeClass("active");e(this).addClass("active");e(".zrdn-tabcontent").removeClass("active");e("#"+e(this).data("tab")).addClass("active");e("input[name=zrdn_active_tab]").val(e(this).data("tab"))});var f=e("#zrdn-preview").html();var b=f.match(/{"@context".*?}}/g,"");if(b){f=f.replace(b[0],"")}var h=/(<.+?>[^<>]*?){([a-zA-Z_].*)_value}([^<>]*?<.+?>)/g;f=f.replace(h,'$1<span id="zrdn_placeholder_$2"></span>$3');e("#zrdn-preview").html(f);e(".prep_time").html('<span id="zrdn_placeholder_prep_time"></span>');e(".cook_time").html('<span id="zrdn_placeholder_cook_time"></span>');e(".zrdn-recipe-image").parent().append('<span class="zrdn-edit-image-text">'+zrdn_editor.str_click_to_edit_image+"</span>");e(".zrdn-field-input").each(function(){if(k==="zrdn_video_url"){return}var k=e(this).attr("name");var j=k.replace("zrdn_","zrdn_placeholder_");e("#"+j).html(e(this).val())});e("input[name=zrdn_video_url]").each(function(){a(e(this))});e("input[type=number]").each(function(){d(e(this))});e(".zrdn-field-textarea").each(function(){c(e(this))});if(e("input[name=zrdn_recipe_image]").val().length>0){e(".zrdn-recipe-image").attr("src",e("input[name=zrdn_recipe_image]").val())}e(document).on("keyup","input[type=text]",function(l){g();var k=e(this).attr("name");if(k==="zrdn_video_url"){return}if(k===undefined){return}if(k.indexOf("zrdn_")===-1){return}var j=k.replace("zrdn_","zrdn_placeholder_");e("#"+j).html(e(this).val())});e(document).on("keyup mouseup","input[type=number]",function(j){d(e(this))});e(document).on("keyup","textarea",function(j){c(e(this))});function d(p){var m=p.attr("name");if(m.indexOf("zrdn_")===-1){return}var l=m.replace("_minutes","").replace("_hours","");var n=parseInt(e("input[name="+l+"_minutes]").val());var j=parseInt(e("input[name="+l+"_hours]").val());var k=l.replace("zrdn_","zrdn_placeholder_");var o="";if(j>0){o+=j+" "+zrdn_editor.str_hours}if(n>0){if(o.length>0){n=", "+n}o+=n+" "+zrdn_editor.str_minutes}e("#"+k).html(o)}function c(m){var k=m.attr("name");if(k.indexOf("zrdn_")===-1){return}var j;var v="UL";var q=k.replace("zrdn_","zrdn_placeholder_");var s=e("#"+q);s.html("");var n=s.outerHTML();if(s.parent().prop("tagName")==="LI"){j=s.parent().parent()}else{j=s.parent()}v=j.prop("tagName");var u=m.val().split("\n");u=u.filter(Boolean);u.forEach(function(y){if(y.substring(0,1)==="!"){n+="</"+v+"><b>"+y.substring(1)+"</b><"+v+">"}else{if(y.substring(0,1)==="%"){var z=/(?:%)([http|https?:\/\/=?\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:\/?#[\]@!\$&'\(\)\*\+,;=.\/]+[a-zA-N])/g;var x=y.match(z);if(x){var w=x[0];var A=w.substring(1);n+=y.replace(w,'<img style="max-width:100%" src="'+A+'">')}}else{n+="<li>"+y+"</li>"}}});if(n.length){var l;var t=/(\*[a-zA-Z\-\_\(\)\<\>\/\\\$\!\@\#\:\;\.\,\?\+\=]*\*)/g;var p=n.match(t);if(p&&p.length){for(l=0;l<p.length;l++){var o=p[l];var r=o;r=r.replace(/\*$/i,"</b>").replace(/^\*/i,"<b>");n=n.replace(o,r)}}t=/\[([^\]\|\[]*)\|([^\]\|\[]*)\]/g;p=n.match(t);if(p&&p.length){for(l=0;l<p.length;l++){n=n.replace(/\[([^\]\|\[]*)\|([^\]\|\[]*)\]/i,'<a href="$1">$2</a>')}}}j.html(n)}var i=null;e(document).on("click",".zrdn-recipe-image",function(){var j=e(this);i=wp.media({frame:"post",state:"insert",multiple:false});i.on("insert",function(){j.wrap('<div class="loading-gif"></div>');e(j).load(function(){j.unwrap()});var n=i.state().get("selection").length;var k=i.state().get("selection").models;for(var m=0;m<n;m++){var l=k[m].id;var o;if(k[m].attributes.sizes.hasOwnProperty("zrdn_recipe_image")){o=k[m].attributes.sizes.zrdn_recipe_image}else{if(k[m].attributes.sizes.hasOwnProperty("large")){o=k[m].attributes.sizes.large}else{o=k[m].attributes.sizes.full}}var p=o.url;j.attr("src",p);e("input[name=zrdn_recipe_image_id]").val(l);e("input[name=zrdn_recipe_image]").val(p)}});i.open()});e(document).on("keyup","input[name=zrdn_video_url]",function(){a(e(this))});function a(m){var k=m.attr("name");if(k===undefined){return}if(k.indexOf("zrdn_")===-1){return}var j=k.replace("zrdn_","zrdn_placeholder_");var l=m.val();e.ajax({type:"GET",url:zrdn_editor.admin_url,dataType:"json",data:({video_url:l,action:"zrdn_get_embed_code"}),success:function(n){if(n.success){e("#"+j).html(n.embed)}}})}setTimeout(function(){for(var j=0;j<tinymce.editors.length;j++){tinymce.editors[j].onChange.add(function(l,n){var m=l.id;var k=m.replace("zrdn_","zrdn_placeholder_");e("#"+k).html(l.getContent())});tinymce.editors[j].onKeyUp.add(function(l,n){var m=l.id;var k=m.replace("zrdn_","zrdn_placeholder_");e("#"+k).html(l.getContent())})}},1000);g();function g(){if(!e("#zrdn-nutrition-label").length){return}var j=e("#zrdn-nutrition-label");if(e("input[name=zrdn_calories]").val().length===0){j.hide()}else{j.show()}}});